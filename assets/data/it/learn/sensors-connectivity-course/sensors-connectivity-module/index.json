{"hash":"5d4f08f99729279cbad41c23c8d66dce511a8ae5","data":{"course":{"id":"5e426754cfad52172a1f164992f132b0","title":"Lezione n. 4, modulo di connettività dei sensori","description":"MODULO DI CONNETTIVITÀ DEI SENSORI","content":"\nNei seguenti articoli, imparerai di più sul modulo di connettività dei sensori. Dopo di che, potrai unirti all'hosting della nostra Rete di Sensori Decentralizzata o creare la tua mappa dei sensori.\n\n## Informazioni sulla connettività dei sensori\n\nLa Rete di Sensori Decentralizzata utilizza il modulo `sensors-connectivity` in Python ([codice sorgente](https://github.com/airalab/sensors-connectivity)). Questo modulo permette a qualsiasi utente di avviare il proprio server per ricevere dati dai sensori e elaborarli ulteriormente. Al momento, gli sviluppatori hanno lanciato diversi server del genere e qualsiasi sensore può inviare dati a essi. L'avvio di server multipli evita la perdita di dati in caso di problemi con uno di essi, poiché i sensori passeranno da un server non funzionante a uno funzionante. Fondamentalmente, puoi pensare al modulo di connettività dei sensori come a una scatola nera con un ingresso (dati del sensore) e molti uscite.\n\n<LessonImages  figure figureCaption=\"Module architecture\" src=\"sensors-connectivity-course/lesson-4-1.png\" alt=\"Module architecture\"/>\n\nIl modulo di connettività dei sensori è un insieme di stazioni (stazione_1, stazione_2 ... stazione_n), che ricevono vari dati, inclusi dati dai sensori tramite protocollo HTTP. Possono anche essere sensori collegati al computer tramite USB o qualsiasi altra fonte di dati. I dati ricevuti dalle stazioni vengono elaborati dal modulo e passati ai feeder (feeder_1, feeder_2 ... feeder_n). I feeder inviano i dati elaborati all'utente; nel nostro caso i dati vengono inviati al canale IPFS decentralizzato. \n\nUna mappa della [Rete di Sensori Decentralizzata](https://sensors.robonomics.network/#/) è un'applicazione decentralizzata (dapp) in esecuzione sul computer. Legge i dati dal canale IPFS e li visualizza sulla mappa. Non c'è una connessione diretta tra il server che raccoglie i dati dai sensori e la mappa che l'utente vede; i dati vengono trasferiti tra loro tramite IPFS pubsub, il che riduce il carico sui server. \n\nInoltre, di tanto in tanto, un file con i dati dell'ultimo periodo di tempo viene memorizzato in IPFS, e un hash di questi dati viene quindi registrato sulla blockchain. Poiché IPFS è una rete basata sui contenuti, memorizzare i dati al suo interno garantisce che qualsiasi modifica ai dati non passi inosservata, poiché l'indirizzo del file necessario contiene un hash del suo contenuto, che cambierà con qualsiasi modifica ai dati. La blockchain viene utilizzata per passare l'hash all'utente, che può usarlo per ottenere i dati necessari da IPFS (questo avviene quando si richiede la cronologia della mappa).\n\n## Configurazione del modulo per Linux\n\n**Prerequisiti e Installazione**\n\n<List type=\"numbers\">\n\n<li>\n\nPer compilare il modulo `sensors-connectivity` è necessario installare il demone IPFS con una versione non superiore a `0.8.x`. Presumendo che tu stia lavorando su Linux, esegui quanto segue (per la versione `0.8.0`):\n\n<LessonCodeWrapper codeClass=\"big-code\" language=\"bash\">wget https://dist.ipfs.io/go-ipfs/v0.8.0/go-ipfs_v0.8.0_linux-amd64.tar.gz\ntar -xzf go-ipfs_v0.8.0_linux-amd64.tar.gz\ncd go-ipfs\nsudo bash install.sh\nipfs init</LessonCodeWrapper>\n\n</li>\n\n\n<li>\n\nInstallare il pacchetto con gli strumenti di sviluppo `python3-dev` e l'installatore di pacchetti per Python `pip`:\n\n<LessonCodeWrapper codeClass=\"long-code\" language=\"bash\">sudo apt install python3-dev python3-pip</LessonCodeWrapper>\n\n</li>\n\n\n<li>\n\nInstallare il modulo come un pacchetto PyPI:\n\n<LessonCodeWrapper codeClass=\"long-code\" language=\"bash\">pip3 install sensors-connectivity</LessonCodeWrapper>\n\nSe si vede il seguente avviso: \n\n<LessonCodeWrapper codeClass=\"big-code\" language=\"bash\">WARNING: The script sensors_connectivity is installed in '/home/test2/.local/bin' which is not on PATH.\nConsider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.</LessonCodeWrapper>\n\nEseguire il comando successivo:\n\n<LessonCodeWrapper  language=\"bash\">cd ~\nexport PATH=\"/usr/local/bin:$PATH\"\nsource .profile</LessonCodeWrapper>\n\n</li>\n\n</List>\n\n## Configurazione\n\n<List type=\"numbers\">\n\n<li>\n\nCreare una directory per il file di configurazione e il file del database ovunque si desideri. Questo database salverà gli hash IPFS dei dati del sensore, il timestamp e lo stato del servizio:\n\n<LessonCodeWrapper language=\"bash\">cd ~\nmkdir sensors_connectivity\ncd sensors_connectivity\ntouch database.db</LessonCodeWrapper>\n\n<RoboAcademyNote type=\"okay\" title=\"INFO\">\nIl nome del file del database può essere qualsiasi, ma l'estensione deve essere <code>.db</code>\n</RoboAcademyNote>\n\n</li>\n\n\n<li>\n\nCreare il file di configurazione nella stessa directory:\n\n<LessonCodeWrapper language=\"bash\">touch my_config.json</LessonCodeWrapper>\n\n</li>\n\n\n<li>\n\nCopiare e incollare quanto segue nel file e inserire il percorso completo del file del database nel campo db_path. Questa configurazione sarà sufficiente per ottenere i dati dei sensori tramite HTTP e inviarli alla mappa Robonomics:\n\n<LessonCodeWrapper codeClass=\"big-code\" language=\"json\">{\n   \"general\": {\n      \"publish_interval\": 30,\n      \"db_path\": \"<YOUR/PATH/TO/DATABASE>\"\n   },\n   \"comstation\": {\n      \"enable\": false,\n      \"port\": \"/dev/<YOUR/PATH/TO/BOARD>\",\n      \"work_period\": 300,\n      \"geo\": \"00.000000,00.000000\",\n      \"public_key\": \"\"\n   },\n   \"httpstation\": {\n      \"enable\": true,\n      \"port\": 8001\n   },\n   \"mqttstation\": {\n      \"enable\": false,\n      \"host\": \"localhost\",\n      \"port\": 1883,\n      \"topic\": \"/freertos_mqtt_robonomics_example/#\",\n      \"username\": \"\",\n      \"password\": \"\"\n   },\n   \"robonomics\": {\n      \"enable\": true,\n      \"ipfs_provider\": \"/ip4/127.0.0.1/tcp/5001/http\",\n      \"ipfs_topic\": \"airalab.lighthouse.5.robonomics.eth\"\n   },\n   \"datalog\": {\n      \"enable\": false,\n      \"suri\": \"\",\n      \"dump_interval\": 60,\n      \"temporal_username\": \"\",\n      \"temporal_password\": \"\",\n      \"pinata_api\": \"\",\n      \"pinata_secret\": \"\"\n   },\n   \"dev\": {\n      \"sentry\": \"\"\n   },\n   \"frontier\": {\n      \"enable\": false,\n      \"suri\": \"\"\n   },\n   \"trackagro\": {\n      \"enable\": false,\n      \"token\": \"\"\n   }\n}</LessonCodeWrapper>\n\n</li>\n\n</List>\n\n## Avvio\n\n\n<List type=\"numbers\">\n\n<li>\n\nAvviare il demone IPFS:\n\n<LessonCodeWrapper codeCLass=\"big-code\" language=\"bash\">ipfs daemon --enable-pubsub-experiment</LessonCodeWrapper>\n\n</li>\n\n\n<li>\n\nDopo aver impostato la configurazione, eseguire il servizio con il percorso del file di configurazione in un'altra finestra del terminale:\n\n<LessonCodeWrapper language=\"bash\">sensors_connectivity \"path/to/your/config/file”</LessonCodeWrapper>\n\n</li>\n\n\n<li>\n\nVedrai i log nel terminale (verranno inoltre aggiunti a `~/.logs`). Esempio:\n\n<LessonCodeWrapper codeClass=\"big-code\" language=\"bash\">$ sensors_connectivity test.json\n2022-09-02 14:08:48,408 - INFO - Getting data from the stations...\n2022-09-02 14:08:48,409 - INFO - airalab-http-v0.8.0: [[]]\n2022-09-02 14:08:48,409 - INFO - Sending result to the feeders...\n2022-09-02 14:08:48,411 - INFO - Checking data base...\n2022-09-02 14:09:18,410 - INFO - Sending result to the feeders...\n2022-09-02 14:09:18,410 - INFO - Getting data from the stations...\n2022-09-02 14:09:18,411 - INFO - airalab-http-v0.8.0: [[]]\n2022-09-02 14:09:48,411 - INFO - Sending result to the feeders...\n2022-09-02 14:09:48,412 - INFO - Getting data from the stations...\n2022-09-02 14:09:48,413 - INFO - airalab-http-v0.8.0: [[]]\n2022-09-02 14:10:18,413 - INFO - Sending result to the feeders...\n2022-09-02 14:10:18,413 - INFO - Getting data from the stations...</LessonCodeWrapper>\n\n</li>\n\n</List>\n\n## Post-installazione\n\nPer connettere il tuo modulo `sensors-connectivity` alla nostra Rete di Sensori Decentralizzata e vedere i tuoi dati sulla mappa, devi inviare il tuo ID IPFS a [vm@multi-agent.io](mailto:vm@multi-agent.io) o [ping@airalab.org](mailto:ping@airalab.org). Aggiungeremo il tuo ID a una lista di controllo degli accessi.\n\nOttieni il tuo ID IPFS con il seguente comando dopo aver avviato il demone IPFS:\n\n<LessonCodeWrapper codeClass=\"big-code\" language=\"bash\">$ ipfs id\n{\n\t\"ID\": \"QmUZxw8jsRpSx5rWkTpJokPGKvWihTrt5rbRCFXzJ4eCAP\",\n\t\"PublicKey\": \"CAASpgIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC/uMV3rLM/C+LOh2DGPo3chr+VM+vyYMKi...\n    ...</LessonCodeWrapper>","fileInfo":{"path":"it/learn/sensors-connectivity-course/sensors-connectivity-module.md","name":"sensors-connectivity-module"},"defaultName":"Sensors Connectivity & Decentralized Sensors Network","lastUpdate":null}},"context":{}}