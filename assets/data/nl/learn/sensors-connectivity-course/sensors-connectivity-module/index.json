{"hash":"39646b78023bddea786f995e516360c6cbdb9af0","data":{"course":{"id":"8de59613cb90b80e15a12e3ae14cc7b9","title":"Les #4, Sensors connectiviteitsmodule","description":"SENSORS CONNECTIVITY MODULE","content":"\nIn de volgende artikelen leer je meer over de Sensor Connectiviteitsmodule. Daarna kun je meedoen aan het hosten van ons Gedecentraliseerde Sensors Netwerk of je eigen sensor map maken.\n\n## Over Sensors Connectiviteit\n\nHet Gedecentraliseerde Sensors Netwerk maakt gebruik van de `sensors-connectivity` Python module ([broncode](https://github.com/airalab/sensors-connectivity)). Deze module stelt elke gebruiker in staat om zijn eigen server te starten om gegevens van sensoren te ontvangen en deze verder te verwerken. Op dit moment hebben de ontwikkelaars verschillende van dergelijke servers gelanceerd en elke sensor kan gegevens naar hen sturen. Het draaien van meerdere servers voorkomt gegevensverlies in geval van problemen met een van hen, omdat de sensoren zullen overschakelen van een niet-werkende server naar een werkende. Je kunt de Sensors Connectiviteitsmodule in feite zien als een black box met één invoer (sensorgegevens) en vele uitgangen.\n\n<LessonImages  figure figureCaption=\"Module architecture\" src=\"sensors-connectivity-course/lesson-4-1.png\" alt=\"Module architecture\"/>\n\nDe Sensors Connectiviteitsmodule is een set van stations (station_1, station_2 ... station_n), die verschillende gegevens ontvangen, waaronder gegevens van sensoren via het HTTP-protocol. Het kunnen ook sensoren zijn die zijn aangesloten op de computer via USB of een andere gegevensbron. De gegevens die van de stations worden ontvangen, worden verwerkt door de module en doorgegeven aan feeders (feeder_1, feeder_2 ... feeder_n). De feeders sturen de verwerkte gegevens naar de gebruiker; in ons geval worden de gegevens naar het gedecentraliseerde IPFS-kanaal gestuurd. \n\nEen kaart van het [Gedecentraliseerde Sensors Netwerk](https://sensors.robonomics.network/#/) is een gedecentraliseerde applicatie (dapp) die op de computer draait. Het leest gegevens uit het IPFS-kanaal en toont deze op de kaart. Er is geen directe verbinding tussen de server die gegevens van de sensoren verzamelt en de kaart die de gebruiker ziet; gegevens worden tussen hen overgedragen via IPFS pubsub, wat de belasting op de servers vermindert. \n\nBovendien wordt van tijd tot tijd een bestand met gegevens voor de laatste periode opgeslagen in IPFS, en een hash van deze gegevens wordt vervolgens opgenomen in de blockchain. Aangezien IPFS een op inhoud gericht netwerk is, zorgt het opslaan van gegevens erin ervoor dat elke gegevenswijziging niet onopgemerkt blijft, omdat het adres van het benodigde bestand een hash van de inhoud bevat, die zal veranderen bij elke gegevenswijziging. De blockchain wordt gebruikt om de hash naar de gebruiker door te geven, die deze kan gebruiken om de benodigde gegevens uit IPFS te halen (dit gebeurt wanneer je een geschiedenis van de kaart opvraagt).\n\n## Module-installatie voor Linux\n\n**Vereisten en Installatie**\n\n<List type=\"numbers\">\n\n<li>\n\nOm de `sensors-connectivity` module te bouwen, moet de IPFS daemon geïnstalleerd zijn met versie niet groter dan `0.8.x`. Als je op Linux werkt, voer dan het volgende uit (voor versie `0.8.0`):\n\n<LessonCodeWrapper codeClass=\"big-code\" language=\"bash\">wget https://dist.ipfs.io/go-ipfs/v0.8.0/go-ipfs_v0.8.0_linux-amd64.tar.gz\ntar -xzf go-ipfs_v0.8.0_linux-amd64.tar.gz\ncd go-ipfs\nsudo bash install.sh\nipfs init</LessonCodeWrapper>\n\n</li>\n\n\n<li>\n\nInstalleer het pakket met ontwikkeltools `python3-dev` en de pakketinstallateur voor Python `pip`:\n\n<LessonCodeWrapper codeClass=\"long-code\" language=\"bash\">sudo apt install python3-dev python3-pip</LessonCodeWrapper>\n\n</li>\n\n\n<li>\n\nInstalleer de module als een PyPI-pakket:\n\n<LessonCodeWrapper codeClass=\"long-code\" language=\"bash\">pip3 install sensors-connectivity</LessonCodeWrapper>\n\nAls je de volgende waarschuwing ziet: \n\n<LessonCodeWrapper codeClass=\"big-code\" language=\"bash\">WARNING: The script sensors_connectivity is installed in '/home/test2/.local/bin' which is not on PATH.\nConsider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.</LessonCodeWrapper>\n\nVoer het volgende commando uit:\n\n<LessonCodeWrapper  language=\"bash\">cd ~\nexport PATH=\"/usr/local/bin:$PATH\"\nsource .profile</LessonCodeWrapper>\n\n</li>\n\n</List>\n\n## Configuratie\n\n<List type=\"numbers\">\n\n<li>\n\nMaak een map aan voor het configuratiebestand en het databasebestand waar je maar wilt. Deze database zal IPFS-hashes van sensorgegevens, tijdstempel en servicestatus opslaan:\n\n<LessonCodeWrapper language=\"bash\">cd ~\nmkdir sensors_connectivity\ncd sensors_connectivity\ntouch database.db</LessonCodeWrapper>\n\n<RoboAcademyNote type=\"okay\" title=\"INFO\">\nDe naam van het databasebestand kan elk zijn, maar de extensie moet zijn <code>.db</code>\n</RoboAcademyNote>\n\n</li>\n\n\n<li>\n\nMaak het configuratiebestand in dezelfde map aan:\n\n<LessonCodeWrapper language=\"bash\">touch my_config.json</LessonCodeWrapper>\n\n</li>\n\n\n<li>\n\nKopieer en plak het volgende in het bestand en voeg het volledige pad naar het databasebestand in het veld db_path in. Deze configuratie zal voldoende zijn om sensorgegevens via HTTP te verkrijgen en naar de Robonomics-kaart te sturen:\n\n<LessonCodeWrapper codeClass=\"big-code\" language=\"json\">{\n   \"general\": {\n      \"publish_interval\": 30,\n      \"db_path\": \"<YOUR/PATH/TO/DATABASE>\"\n   },\n   \"comstation\": {\n      \"enable\": false,\n      \"port\": \"/dev/<YOUR/PATH/TO/BOARD>\",\n      \"work_period\": 300,\n      \"geo\": \"00.000000,00.000000\",\n      \"public_key\": \"\"\n   },\n   \"httpstation\": {\n      \"enable\": true,\n      \"port\": 8001\n   },\n   \"mqttstation\": {\n      \"enable\": false,\n      \"host\": \"localhost\",\n      \"port\": 1883,\n      \"topic\": \"/freertos_mqtt_robonomics_example/#\",\n      \"username\": \"\",\n      \"password\": \"\"\n   },\n   \"robonomics\": {\n      \"enable\": true,\n      \"ipfs_provider\": \"/ip4/127.0.0.1/tcp/5001/http\",\n      \"ipfs_topic\": \"airalab.lighthouse.5.robonomics.eth\"\n   },\n   \"datalog\": {\n      \"enable\": false,\n      \"suri\": \"\",\n      \"dump_interval\": 60,\n      \"temporal_username\": \"\",\n      \"temporal_password\": \"\",\n      \"pinata_api\": \"\",\n      \"pinata_secret\": \"\"\n   },\n   \"dev\": {\n      \"sentry\": \"\"\n   },\n   \"frontier\": {\n      \"enable\": false,\n      \"suri\": \"\"\n   },\n   \"trackagro\": {\n      \"enable\": false,\n      \"token\": \"\"\n   }\n}</LessonCodeWrapper>\n\n</li>\n\n</List>\n\n## Start\n\n\n<List type=\"numbers\">\n\n<li>\n\nStart IPFS-daemon:\n\n<LessonCodeWrapper codeCLass=\"big-code\" language=\"bash\">ipfs daemon --enable-pubsub-experiment</LessonCodeWrapper>\n\n</li>\n\n\n<li>\n\nNadat de configuratie is ingesteld, voer de service uit met het pad naar het configuratiebestand in een andere terminal:\n\n<LessonCodeWrapper language=\"bash\">sensors_connectivity \"path/to/your/config/file”</LessonCodeWrapper>\n\n</li>\n\n\n<li>\n\nJe zult logs in de terminal zien (ze zullen ook worden toegevoegd aan `~/.logs`). Voorbeeld:\n\n<LessonCodeWrapper codeClass=\"big-code\" language=\"bash\">$ sensors_connectivity test.json\n2022-09-02 14:08:48,408 - INFO - Getting data from the stations...\n2022-09-02 14:08:48,409 - INFO - airalab-http-v0.8.0: [[]]\n2022-09-02 14:08:48,409 - INFO - Sending result to the feeders...\n2022-09-02 14:08:48,411 - INFO - Checking data base...\n2022-09-02 14:09:18,410 - INFO - Sending result to the feeders...\n2022-09-02 14:09:18,410 - INFO - Getting data from the stations...\n2022-09-02 14:09:18,411 - INFO - airalab-http-v0.8.0: [[]]\n2022-09-02 14:09:48,411 - INFO - Sending result to the feeders...\n2022-09-02 14:09:48,412 - INFO - Getting data from the stations...\n2022-09-02 14:09:48,413 - INFO - airalab-http-v0.8.0: [[]]\n2022-09-02 14:10:18,413 - INFO - Sending result to the feeders...\n2022-09-02 14:10:18,413 - INFO - Getting data from the stations...</LessonCodeWrapper>\n\n</li>\n\n</List>\n\n## Na installatie\n\nOm je `sensors-connectivity` module aan te sluiten op ons Gedecentraliseerde Sensors Netwerk en je gegevens op de kaart te zien, moet je je IPFS ID sturen naar [vm@multi-agent.io](mailto:vm@multi-agent.io) of [ping@airalab.org](mailto:ping@airalab.org). We zullen je ID toevoegen aan een toegangscontrolelijst.\n\nHaal je IPFS `ID` op met het volgende commando nadat je de IPFS-daemon hebt gestart:\n\n<LessonCodeWrapper codeClass=\"big-code\" language=\"bash\">$ ipfs id\n{\n\t\"ID\": \"QmUZxw8jsRpSx5rWkTpJokPGKvWihTrt5rbRCFXzJ4eCAP\",\n\t\"PublicKey\": \"CAASpgIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC/uMV3rLM/C+LOh2DGPo3chr+VM+vyYMKi...\n    ...</LessonCodeWrapper>","fileInfo":{"path":"nl/learn/sensors-connectivity-course/sensors-connectivity-module.md","name":"sensors-connectivity-module"},"defaultName":"Sensors Connectivity & Decentralized Sensors Network","lastUpdate":null}},"context":{}}