{"hash":"8ef03bb5d0758af9cf9521a2138c5ca6b002a78d","data":{"course":{"id":"b056e29199a34da657edd1dde7f65b22","title":"Les #4b, Gateway Setup: Robonomics SLS Gateway","description":"thuiscursus assistent","content":"\n## Waar gaat dit over\n\nDit is een scenario-opstelling voor het verbinden van apparaten met behulp van de Robonomics SLS Gateway. Robonomics heeft ontwerpinspiratie opgedaan uit de gateway ontwikkeld door het [Smart Logic System](https://github.com/slsys/Gateway) project en een deel van de schakeling aangepast. U kunt een gateway bestellen bij Robonomics of zelf bouwen met behulp van onze [blauwdrukken](https://oshwlab.com/ludovich88/robonomics_sls_gateway_v01).\n\nJe installeert de benodigde software voor de gateway, configureert deze en koppelt hem aan Home Assistant.\n\n<robo-academy-note type=\"note\" title=\"Attention\">\n  SmartRF Flash Programmer, een programma voor het bijwerken van firmware, vereist Windows besturingssysteem.\n</robo-academy-note>\n\n## Instructies\n\n<List type=\"numbers\">\n\n<li>\n\nInstalleren van Zigbee Microcontroller Firmware\n\n<List>\n\n<li>\n\nEerst moet u de CC2652P microcontroller van de gateway flashen. Zet de schakelaars <code>2</code>, <code>4</code> en <code>7</code> aan de onderkant van de SLS Gateway op <code>AAN</code>, de andere moeten <code>UIT</code> zijn.\n\n<LessonImages src=\"smart-house-course/lesson-4-b-1.png\" alt=\"controllers\"/>\n</li>\n\n<li>\n\nSluit de gateway aan op uw computer met een USB-A<>USB-C kabel.\n\n<robo-academy-note type=\"warning\" title=\"WARNING\">\n  Gebruik alstublieft alleen USB-A<>USB-C type kabels, omdat de gateway op dit moment geen USB-C<>USB-C type ondersteunt.\n</robo-academy-note>\n\n</li>\n\n<li>\n\nDe CC2652 firmware vereist SmartRF Flash Programmer v2 van Texas Instrument. Download het van [de officiële site](https://www.ti.com/tool/download/FLASH-PROGRAMMER-2) en installeer het vervolgens.\n\n</li>\n\n<li>\n\nDownload firmware voor CC2652P microcontroller van [GitHub repository](https://github.com/egony/cc2652p_cc1352p_RF-STAR/tree/main/firmware/coordinator).\n\n</li>\n\n<li>\n\nStart het programma. Selecteer in het <code>Verbonden apparaat</code> venster de CC2652P microcontroller, stel het pad naar de firmware in, stel de vlaggen in op <code>Wissen, Programmeren, Verifiëren</code> zoals op de afbeelding en druk op <code>Start</code>.\n\n<LessonImages src=\"smart-house-course/lesson-4-b-2.png\" alt=\"tutorial\" imageClasses=\"mb\"/>\n\nNa succesvol flashen ziet u een <code>Succes!</code> bericht. Nu kunt u de USB-kabel loskoppelen.\n\n</li>\n</List>\n</li>\n\n<li>\n\nInstalleren van Microcontroller Firmware\n\n<List>\n\n<li>\n\nNu moet u de gateway instellen voor software-installatie. We raden u aan de firmware bij te werken door de gateway rechtstreeks op uw Raspberry Pi aan te sluiten en alle volgende commando's op dat apparaat in te voeren. \n\n</li>\n\n<li>\n\nZet schakelaars <code>1</code> en <code>3</code> aan de onderkant van de SLS gateway op <code>AAN</code>, de andere moeten <code>UIT</code> zijn. Sluit vervolgens de gateway aan op uw Raspberry Pi via de USB type-C poort.\n\n<LessonImages src=\"smart-house-course/lesson-4-b-3.gif\" alt=\"tutorial\" imageClasses=\"mb\"/>\n\n</li>\n\n<li>\n\nVerbind met de Raspberry Pi via SSH.\n\n<LessonCodeWrapper language=\"bash\" noLines>\nssh ubuntu@192.168.xxx.xxx\n</LessonCodeWrapper>\n\n</li>\n\n<li>\n\nKloon het repository met firmware:\n\n<LessonCodeWrapper language=\"bash\" codeClass=\"big-code\" noLines>\ngit clone https://github.com/airalab/robonomics-hass-utils.git\n</LessonCodeWrapper>\n</li>\n\n<li>\n\nOm de SLS gateway te flashen moet u de scripts <code>Clear</code> en <code>Flash_16mb</code> uitvoeren:\n\n<LessonCodeWrapper language=\"bash\" noLines>\ncd robonomics-hass-utils/esp_firmware/linux\n</LessonCodeWrapper>\n\n<LessonCodeWrapper language=\"bash\" noLines>\nsudo chmod +x Clear.sh\n</LessonCodeWrapper>\n\n<LessonCodeWrapper language=\"bash\" noLines>\nsudo chmod +x Flash_16mb.sh\n</LessonCodeWrapper>\n\n<LessonCodeWrapper language=\"bash\" noLines>\n./Clear.sh\n</LessonCodeWrapper>\n\n<LessonCodeWrapper language=\"bash\" noLines>\n./Flash_16mb.sh\n</LessonCodeWrapper>\n</li>\n\n<li class=\"no-bullet\">\n\n\\- **Probleemoplossing**\n\nAls u problemen ondervindt bij het bijwerken van de gateway firmware, moet u extra stappen ondernemen:\n\n<List>\n\n<li>\n\nZorg ervoor dat de pySerial module is geïnstalleerd:\n\n<LessonCodeWrapper language=\"bash\" noLines>\npip install pyserial\n</LessonCodeWrapper>\n\n</li>\n\n<li>\n\nGeef uw gebruiker toegangsrechten tot de USB-poort:\n\n<LessonCodeWrapper language=\"bash\" noLines>\nsudo usermod -a -G dialout $USER\n</LessonCodeWrapper>\n\n</li>\n\n<li>\n\nIn sommige gevallen is het nodig om de bandbreedte-instelling in het script te wijzigen om de firmware bij te werken. Open het <code>Flash_16mb.sh</code> script met de nano-editor en wijzig de baud parameter van <code>921600</code> naar een kleinere waarde (bijvoorbeeld <code>115200</code>).\n</li>\n</List>\n</li>\n\n<li class=\"no-bullet\">\n\n\\- **Extra**\n\nWe bieden ook opties voor het bijwerken van de firmware met behulp van andere besturingssystemen (macOS en Windows). U kunt bijbehorende scripts vinden in een map, waarvan de naam afhankelijk is van uw OS.\n\n</li>\n</List>\n</li>\n\n<li>\n\nHet instellen van de Gateway\n\n<List>\n\n<li>\n\nZet de schakelaars aan de achterkant van de gateway op hun nieuwe positie. Schakelaars <code>5</code> (RX Zigbee naar ESP) en <code>6</code> (TX Zigbee naar ESP) moeten in de <code>AAN</code> positie staan, de anderen moeten <code>UIT</code> zijn.\n\n\n<LessonImages src=\"smart-house-course/lesson-4-b-4.gif\" alt=\"tutorial\" imageClasses=\"mb\"/>\n\n</li>\n\n<li>\n\nSluit de type-C voedingskabel aan. Het indicatorlampje in het midden moet groen worden.\n\n</li>\n\n<li>\n\nBij de eerste opstart zal de gateway Wi-Fi delen met de SSID <code>zgw****</code>. Maak verbinding met dit netwerk. Houd er rekening mee dat het signaal mogelijk vrij zwak is, dus het is beter om de SLS-gateway dichter bij uw computer te houden.\n\nAls de verbinding succesvol is, wordt de webinterface geopend (of u kunt deze vinden op het adres 192.168.1.1).\n\n</li>\n\n<li>\n\nGa naar de Wi-Fi pagina en voer uw Wi-Fi referenties in door de gebruiker / wachtwoord in te voeren en druk op de <code>Opslaan</code> knop. Druk daarna op de <code>Opnieuw opstarten</code> knop. De gateway zal herstarten en verbinding maken met uw Wi-Fi netwerk.\n\n<LessonVideo  :videos=\"[{src: 'https://crustipfs.info/ipfs/QmSht6roENzrV6oqsQ1a5gp6GVCz54EDZdPAP8XVh9SCwH', type:'mp4'}]\" />\n\n</li>\n\n<li>\n\nZoek het lokale IP-adres van de SLS-gateway om toegang te krijgen tot de webinterface. Hiervoor kunt u de [Fing](https://www.fing.com/products) app gebruiken of <code>arp -a</code> in uw terminal of Nmap: \n\n<LessonCodeWrapper language=\"bash\" noLines>\nsudo nmap -sP 192.168.xxx.0/24\n</LessonCodeWrapper>\n\nwaar <code class=\"bold\">xxx</code> uw IP-adres in het lokale netwerk is. De gatewaynaam moet er zo uitzien: <code>zgw****</code>. Open de webinterface van de gateway door het gateway-IP-adres in een browser te plakken.\n</li>\n\n<li>\n\nGa naar <code>Instellingen</code> -> <code>Hardware</code> en zorg ervoor dat de instellingen eruit zien zoals op de afbeelding. Corrigeer de instellingen indien nodig en klik op de <code>Opslaan</code> knop:\n\n<LessonVideo  :videos=\"[{src: 'https://crustipfs.info/ipfs/QmeSksMxU9xkvvK7f81WDAYULiMFokK7P7KDVYEjv2MHjn', type:'mp4'}]\" />\n\nDe tabel met vereiste waarden:\n\n\n| Field        \t         | **Value**          |                                                                     \t\n|------------------------|--------------------|\n| Zigbee module          | TI                 |\n| Zigbee UART RX         | 22                 |\n| Zigbee UART TX         | 23                 |\n| Zigbee RST Pin         | 18                 |\n| Zigbee BSL Pin         | 19                 |\n| Button Mode            | 33 (pullUP - true) |\n| Number addressable leds| 0                  |\n| Led Red (or addr)      | 21                 |\n| Led Green              | 5                  |\n| Led Blue               | 27                 |\n| I2C SDA                | 255                |\n| I2C SCL                | 255                |\n\n</li>\n\n<li>\n\nHerstart vervolgens de gateway. Kies <code>Acties</code> -> <code>Systeem herstarten</code> in de rechterbovenhoek. Zorg ervoor dat de gateway goed werkt met de CC2652P microcontroller in het Zigbee info venster. DeviceState moet <code>OK</code> zijn.\n\n</li>\n\n<li>\n\nHerstart de gateway. Kies <code>Acties</code> -> <code>Herstarten</code> systeem in de rechterbovenhoek.\n\n</li>\n\n<li>\n\nConfigureer automatisch het toevoegen van apparaten aan Home Assistant. Ga naar <code>Zigbee</code> -> <code>Configuratie</code> en kies vervolgens <code>Home Assistant MQTT Discovery</code> en <code>Staten wissen</code>. Sla de wijzigingen op en herstart opnieuw de SLS gateway.\n\n<LessonVideo  :videos=\"[{src: 'https://crustipfs.info/ipfs/QmVZMB1xQeB6ZLfSR6aUrN6cRSF296s8CMJt7E2jBJ5MjZ', type:'mp4'}]\" />\n\n</li>\n\n<li class=\"no-bullet\">\n\n\\- **Extra**:\n\nAls je al een actieve SLS gateway in huis hebt, en je nu een andere aan het configureren bent, dan zullen ze met elkaar conflicteren. Om dit probleem op te lossen moet je het kanaal op het nieuwe apparaat wijzigen.\n\nGa hiervoor naar <code>Zigbee</code> -> <code>Configuratie</code> en verander het kanaal naar een ander (bijv. kanaal 15).\n\n</li>\n\n<li>\n\nVerbind je apparaten door naar <code>Zigbee</code> -> <code>Verbinden</code> te gaan. Zet je sensoren in koppelingsmodus, de meest gebruikelijke manier om een apparaat in verbindingsmodus te zetten is door de aan/uit-knop ingedrukt te houden of ze 5 keer aan/uit te schakelen. Druk op de <code>Inschakelen</code> knop om Zigbee apparaten te zoeken. Je zult actieve sensoren zien.\n\n</li>\n</List>\n</li>\n\n<li>\n\nSLS Gateway verbinden met Home Assistant\n\n<List>\n\n<li>\n\nJe moet MQTT configureren op de SLS Gateway. Ga terug naar de webinterface van je SLS Gateway en ga naar <code>Instellingen</code> -> <code>Link</code> -> <code>MQTT Setup</code>.\n\n<LessonVideo  :videos=\"[{src: 'https://crustipfs.info/ipfs/QmdNKDqwwy87VQEDDVsX5kpaDQm9wKKPEJUNJnhnjx6e5y', type:'mp4'}]\" />\n\n</li>\n\n<li>\n\nVoeg het adres van je broker toe (het adres van de Raspberry Pi met Home Assistant in het lokale netwerk, je kunt dit vinden met de [Fing](https://www.fing.com/products) app of door het <code>ip -a</code> commando te gebruiken op je RPi), poort (standaard is 1883), je broker gebruikersnaam en wachtwoord (die je eerder hebt aangemaakt) en de onderwerpsnaam (je kunt elke kiezen). Ook moet het lokale Raspberry Pi IP-adres statisch zijn.\n\nVergeet niet om op <code>Inschakelen</code> en <code>Staten behouden</code> te klikken.\n\n</li>\n\n<li>\n\nSla de wijzigingen op. Nu worden apparaten automatisch weergegeven in Home Assistant.\n\n</li>\n</List>\n\n</li>\n\n<li>\n\nVerbind Apparaten \n\n<List>\n\n<li>\n\nVerbind je apparaten door naar <code>Zigbee</code> -> <code>Verbinden</code> te gaan. Zet je sensoren in koppelingsmodus, de meest gebruikelijke manier om een apparaat in verbindingsmodus te zetten is door de aan/uit-knop ingedrukt te houden of ze 5 keer aan/uit te schakelen.\n\n<LessonImages src=\"smart-house-course/lesson-4-a-4.gif\" alt=\"tutorial\" imageClasses=\"mb\"/>\n\n<LessonVideo  :videos=\"[{src: 'https://crustipfs.info/ipfs/Qmdq3PBNY88QbYYqakwSLG2vn3mVUom3w3wsSWfTd1pzJA', type:'mp4'}]\" />\n\n</li>\n\n<li>\n\nDruk op de Inschakelen knop om Zigbee apparaten te zoeken. Je zult actieve sensoren zien.\n\n</li>\n\n</List>\n</li>\n\n</List>","fileInfo":{"path":"nl/learn/smart-home-course/gateway-setup-robonomics-sls-gateway.md","name":"gateway-setup-robonomics-sls-gateway"},"defaultName":"Sovereign Smart Home with Robonomics and Home Assistant","lastUpdate":"Thu May 18 2023 16:16:20 GMT+0400 (Samara Standard Time)"}},"context":{}}