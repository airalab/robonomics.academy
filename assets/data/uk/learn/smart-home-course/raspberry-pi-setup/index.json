{"hash":"1eafca61b16c3525f2f7c5d47de816b7adf0794c","data":{"course":{"id":"777d0313bdd39872eb1fc5342aca93e0","title":"Урок №2, Налаштування Raspberry Pi","description":"курс домашнього асистента","content":"\n## Вступ\n\nУ цьому уроці ви підготуєте свій Raspberry Pi до перетворення на центр Інтернету речей. Ви послідовно встановите та налаштуєте всі необхідні компоненти, а саме:\n\n<List>\n\n- Дистрибутив Ubuntu Linux для Raspberry Pi як операційна система сервера;\n- Пакети Home Assistant;\n- Пакети IPFS;\n- бібліотека robonomics-interface.\n\n</List>\n\n## Інструкції\n\n<List type=\"numbers\">\n\n<li>\n\nПідготовка та налаштування Raspberry Pi\n\n<List>\n\n  <li>\n\n  Завантажте образ [64-бітного Ubuntu Server 22.04 LTS](https://ubuntu.com/download/raspberry-pi) або новіший для Raspberry Pi.\n  </li>\n\n  <li>\n\n  Завантажте та встановіть інструмент для запису образів дисків під назвою [Raspberry Pi Imager](https://www.raspberrypi.com/software/) на ваш комп'ютер.\n  </li>\n\n  <li>\n\n  Вставте SD-карту та запустіть Raspberry Pi Imager. Виберіть потрібний образ (який ви щойно завантажили) як операційну систему та переконайтся, що ви вибрали вашу SD-карту зі списку зберігання.\n\n  </li>\n\n  <li>\n\n  Відкрийте налаштування та встановіть опцію <code>Увімкнути SSH</code> з параметром <code>Використовувати аутентифікацію за паролем</code>.\n\n  \\- У розділі <code>Встановити ім'я користувача та пароль</code> додайте ім'я користувача та пароль для вашого користувача Raspberry Pi.\n\n  \\- У розділі <code>Налаштувати бездротову мережу</code> вкажіть вашу Wi-Fi та її пароль та виберіть вашу країну зі списку. Потім <code>Записати</code> образ.\n\n  <robo-academy-note type=\"okay\">\n  Переконайтеся, що ви вводите ваше справжнє ім'я Wi-Fi та пароль Wi-Fi.\n  </robo-academy-note>\n\n  <LessonVideo  :videos=\"[{src: 'https://crustipfs.info/ipfs/QmY3mEGvUNDT9bKhVhR21JY8RaWp3CB8JNAX1VDHMnwjxw', type:'mp4'}]\" />\n\n  </li>\n\n  <li>\n\n  Зачекайте, поки завершиться запис, потім вставте SD-карту в Raspberry Pi та увімкніть його. Він повинен підключитися до вашої Wi-Fi мережі, що займе деякий час.\n\n  </li>\n  \n  <li>\n\n  Тепер вам потрібно знайти адресу пристрою. Для цього ви можете використовуват різні методи для сканування мережі, наприклад [Fing App](https://www.fing.com/products), команду <code>arp -a</code> або [nmap](https://nmap.org/download.html). Останнє буде використано далі.\n\n  Встановіть nmap за допомогою команди\n\n  <LessonCodeWrapper language=\"bash\" noLines>sudo apt-get install nmap</LessonCodeWrapper>\n\n  Потім знайдіть свою адресу в локальній мережі. Вона повинна виглядати як <code>192.168.xxx.xxx</code> або <code>172.xxx.xxx.xxx.</code> Зверніть увагу, оскільки nmap може знайти багато адрес у вашій локальній мережі.\n\n  <LessonCodeWrapper language=\"bash\" noLines>ip a</LessonCodeWrapper>\n\n  Потім проскануйте свою мережу, як показано нижче, замінивши останній октет адреси на <code>0</code>:\n\n  <LessonCodeWrapper language=\"bash\" noLines>sudo nmap -sP 192.168.xxx.0/24</LessonCodeWrapper>\n\n  Вивід команди буде схожий на це:\n\n<LessonCodeWrapper language=\"bash\" codeClass=\"big-code\" noCopyIcon noLines>\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:50 CEST\nNmap scan report for _gateway (192.168.43.1)\nHost is up (0.015s latency).\nMAC Address: 8E:F5:A3:DB:02:24 (Unknown)\nNmap scan report for ubuntu (192.168.43.56)\nHost is up (0.049s latency).\nMAC Address: DC:A6:32:04:45:50 (Raspberry Pi Trading)\nNmap scan report for LAPTOP-NO7 (192.168.43.234)\nHost is up (0.00057s latency).\nMAC Address: 7C:B3:7D:9E:94:DA (Intel Corporate)\nNmap scan report for ed-vm (192.168.43.138)\nHost is up.\nNmap done: 256 IP addresses (4 hosts up) scanned in 2.07 seconds\n</LessonCodeWrapper>\n\n  У цьому прикладі адреса - <code>192.168.43.56.</code>\n\n  </li>\n\n  <li>\n\n  Підключіться до Raspberry Pi через SSH за знайденою IP-адресою. Використовуйте ім'я користувача та пароль, які ви створили раніше.\n  \n  <LessonCodeWrapper language=\"bash\" noLines>ssh ubuntu@192.168.43.56</LessonCodeWrapper>\n\n  Далі інструкції виконуються через SSH на самому Raspberry Pi.\n  \n  </li>\n</List>\n</li>\n\n<li>\n\nУстановка Home Assistant\n\n<List>\n  <li>\n\n  <robo-academy-note type=\"okay\">\n\nДеякі показані нижче версії програмного забезпечення можуть бути застарілими. Для отримання останніх версій ви можете звернутися до [репозиторію установки зображення Robonomics Home Assistant](https://github.com/airalab/Robonomics-HomeAssistant-image/tree/main/robonomics-stage).\n\n  </robo-academy-note>\n\n  Перед початком оновіть систему Raspberry Pi та встановіть необхідні пакети. Під час установки ви побачите вікно з запитом на перезапуск служби. Просто виберіть <span class=\"accent\">ok</span> за допомогою кнопки <code>tab</code> та натисніть enter.\n\n  <LessonCodeWrapper language=\"bash\" noLines>sudo apt-get update</LessonCodeWrapper>\n\n  <LessonCodeWrapper language=\"bash\" noLines>sudo apt-get upgrade -y</LessonCodeWrapper>\n\n  <LessonCodeWrapper language=\"bash\" codeClass=\"big-code\" noLines>sudo apt-get install -y python3 python3-dev python3-venv python3-pip bluez libffi-dev libssl-dev libjpeg-dev zlib1g-dev autoconf build-essential libopenjp2-7 libtiff5 tzdata libcurl4-openssl-dev subversion libturbojpeg0-dev python3-serial curl</LessonCodeWrapper>\n\n  </li>\n\n  <li>\n  \n  Створіть користувача <code>homeassistant</code> та каталог для Home Assistant Core:\n\n  <LessonCodeWrapper language=\"bash\" noLines>sudo useradd -rm homeassistant -d /srv/homeassistant -G dialout</LessonCodeWrapper>\n  \n  </li>\n\n  <li>\n\n  Створіть віртуальне середовище для Home Assistant Core та перейдіть до нього. Це повинно бути зроблено як користувач <code>homeassistant</code>, тому після виконання команд ваш користувач буде виглядати як <code>(homeassistant) homeassistant@ubuntu</code>:\n\n  <LessonCodeWrapper language=\"bash\" noLines>sudo -u homeassistant -H -s</LessonCodeWrapper>\n\n  <LessonCodeWrapper language=\"bash\" noLines>cd /srv/homeassistant</LessonCodeWrapper>\n\n  <LessonCodeWrapper language=\"bash\" noLines>python3 -m venv .</LessonCodeWrapper>\n\n  <LessonCodeWrapper language=\"bash\" noLines>source bin/activate</LessonCodeWrapper>\n\n  В результаті ви знайдете назву віртуального середовища у дужках:\n\n<LessonCodeWrapper language=\"bash\" codeClass=\"big-code\" noLines noCopyIcon>\n(homeassistant) homeassistant@ubuntu:/srv/homeassistant/$\n</LessonCodeWrapper>\n\n  </li>\n\n  <li>\n\n  Встановіть необхідні пакети Python:\n\n  <LessonCodeWrapper language=\"bash\" noLines>python3 -m pip install wheel~=0.37</LessonCodeWrapper>\n\n  <LessonCodeWrapper language=\"bash\" codeClass=\"big-code\" noLines>pip3 install sqlalchemy~=1.4 fnvhash~=0.1 aiodiscover==1.4.11</LessonCodeWrapper>\n\n  <LessonCodeWrapper language=\"bash\" noLines>pip3 install homeassistant~=2023.3.6 psutil-home-assistant~=0.0</LessonCodeWrapper>\n  \n  </li>\n\n  <li>\n  \n  Почніть Home Assistant Core вперше. Це завершить встановлення автоматично створивши каталог конфігурації <code class=\"nowb\">.homeassistant</code> в каталозі <code>/home/homeassistant</code> та встановивши будь-які основні залежності:\n  \n<LessonCodeWrapper language=\"bash\" noLines>hass</LessonCodeWrapper>\n  \n  </li>\n\n  <li>\n\n  Поки триває початкове налаштування, перевірте своє встановлення через веб-інтерфейс за адресою <code>http://%RASPBERRY_IP_ADDRESS%:8123</code>. У цьому прикладі: <code>http://192.168.43.56:8123</code>. Ви можете відкрити веб-інтерфейс з будь-якого комп'ютера, підключеного до вашої локальної мережі.\n\n  Зачекайте, поки ви побачите вікна з вітанням з можливістю створення логіна / пароля, а потім зупиніть Home Assistant за допомогою <code>Ctrl+C</code>.\n  </li>\n</List>\n</li>\n\n<li>\n\nВстановлення IPFS\n\n<List>\n\n  <li>\n\n  Для встановлення IPFS ви можете скористатися нашим скриптом для завантаження IPFS та створення служби systemd з ним. Спочатку вийдіть з віртуального середовища для Home Assistant:\n\n<LessonCodeWrapper language=\"bash\" noLines>exit</LessonCodeWrapper>\n\n  Потім виконайте:\n\n  <LessonCodeWrapper language=\"bash\" noLines>cd ~</LessonCodeWrapper>\n  <LessonCodeWrapper language=\"bash\" codeClass=\"big-code\" noLines>wget https://raw.githubusercontent.com//airalab/homeassistant-robonomics-integration/main/install_ipfs.sh</LessonCodeWrapper>\n  <LessonCodeWrapper language=\"bash\" noLines>sudo chmod +x install_ipfs.sh</LessonCodeWrapper>\n  <LessonCodeWrapper language=\"bash\" noLines>./install_ipfs.sh</LessonCodeWrapper>\n\n</li>\n</List>\n</li>\n\n<li>\n\nСлужби Systemd\n\n<List>\n\n<li>\n\nСлужба systemd корисна для автоматизації запуску Home Assistant. Створіть нову службу для Home Assistant:\n\n<LessonCodeWrapper language=\"bash\" codeClass=\"big-code\" noLines>\nsudo nano /etc/systemd/system/home-assistant@homeassistant.service\n</LessonCodeWrapper>\n\n</li>\n\n<li>\n\nВставте наступне\n\n<LessonCodeWrapper language=\"bash\">\n[Unit]\nDescription=Home Assistant\nAfter=network-online.target\n[Service]\nType=simple\nRestart=on-failure\nUser=%i\nWorkingDirectory=/srv/%i/\nExecStart=/srv/homeassistant/bin/hass -c \"/srv/%i/.homeassistant\"\nEnvironment=\"PATH=/srv/%i/bin\"\n[Install]\nWantedBy=multi-user.target\n</LessonCodeWrapper>\n\n</li>\n\n<li>\n\nУвімкніть та запустіть службу:\n\n<LessonCodeWrapper language=\"bash\" codeClass=\"big-code\" noLines>\nsudo systemctl enable home-assistant@homeassistant.service\n</LessonCodeWrapper>\n\n<LessonCodeWrapper language=\"bash\" codeClass=\"big-code\" noLines>\nsudo systemctl start home-assistant@homeassistant.service\n</LessonCodeWrapper>\n\n</li>\n</List>\n</li>\n\n<li>\n\nІнтеграція Robonomics\n\n<List>\n\n<li>\n\nУвійдіть під користувачем <code>homeassistant</code> на вашому Raspberry Pi:\n\n<LessonCodeWrapper language=\"bash\" noLines>\nsudo -u homeassistant -H -s\n</LessonCodeWrapper>\n\n</li>\n\n<li>\n\nАктивуйте віртуальне середовище та встановіть необхідні пакети Python:\n\n\n<LessonCodeWrapper language=\"bash\" noLines>\nsource /srv/homeassistant/bin/activate\n</LessonCodeWrapper>\n\n<LessonCodeWrapper language=\"bash\" noLines>\npip3 install robonomics-interface~=1.6.0\n</LessonCodeWrapper>\n\n</li>\n\n<li>\n\nПотім перейдіть до каталогу <code>.homeassistant</code>, створіть папку <code class=\"nowb\">custom_components</code> та клонуйте туди репозиторій з інтеграцією:\n\n\n<LessonCodeWrapper language=\"bash\" noLines>\ncd ~/.homeassistant\n</LessonCodeWrapper>\n\n<LessonCodeWrapper language=\"bash\" noLines>\nmkdir custom_components\n</LessonCodeWrapper>\n\n<LessonCodeWrapper language=\"bash\" noLines>\ncd custom_components\n</LessonCodeWrapper>\n\n<LessonCodeWrapper language=\"bash\" codeClass=\"big-code\" noLines>\nsvn checkout https://github.com/airalab/homeassistant-robonomics-integration/trunk/custom_components/robonomics\n</LessonCodeWrapper>\n\n</li>\n\n\n<li>\n\nПісля цього вийдіть з користувача homeassistant та перезапустіть службу:\n\n<LessonCodeWrapper language=\"bash\" noLines>\nexit\n</LessonCodeWrapper>\n\n<LessonCodeWrapper language=\"bash\" codeClass=\"big-code\" noLines>\nsudo systemctl restart home-assistant@homeassistant.service\n</LessonCodeWrapper>\n\n</li>\n</List>\n</li>\n\n</List>\n\n\n\n","fileInfo":{"path":"uk/learn/smart-home-course/raspberry-pi-setup.md","name":"raspberry-pi-setup"},"defaultName":"Sovereign Smart Home with Robonomics and Home Assistant","lastUpdate":"Thu May 18 2023 10:46:29 GMT+0400 (Samara Standard Time)"}},"context":{}}