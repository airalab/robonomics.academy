{"hash":"1eafca61b16c3525f2f7c5d47de816b7adf0794c","data":{"course":{"id":"5e17e304169fe551fc2ef4c4d6911a71","title":"Lección #3, Configuración del Broker MQTT e Inicio de Hass","description":"curso de asistente doméstico","content":"\n## Introducción\n\nDespués de terminar la configuración de Raspberry Pi, el siguiente paso es instalar el Broker MQTT en el Raspberry Pi. Como se mencionó anteriormente, el Broker es responsable de la ruta de mensajes entre diferentes clientes MQTT. Instalarás y configurarás Eclipse Mosquitto, un Broker MQTT de código abierto.\n\n<LessonImages src=\"smart-house-course/lesson-3-1.jpg\" alt=\"scheme\" imageClasses=\"mb\"/>\n\nAdemás, completarás la configuración de Home Assistant y agregarás la integración MQTT a él.\n\n## Instrucciones\n\n<List type=\"numbers\">\n\n<li>\n\n\nInstalación del Broker Mosquitto\n\n<List>\n<li>\n\nInstala [Mosquitto Broker](https://mosquitto.org/) en tu Raspberry Pi:\n\n\n<LessonCodeWrapper language=\"bash\" noLines>\nsudo apt install mosquitto mosquitto-clients -y\n</LessonCodeWrapper>\n</li>\n\n<li>\n\nIngresa TU_NOMBRE_DE_USUARIO (usa el que desees) y contraseña (se te pedirá ingresar la contraseña después del comando):\n\n<LessonCodeWrapper language=\"bash\" noLines codeClass=\"big-code\">\nsudo mosquitto_passwd -c /etc/mosquitto/passwd YOUR_USERNAME\n</LessonCodeWrapper>\n\n</li>\n\n<li>\n\nEdita el archivo de configuración:\n\n<LessonCodeWrapper language=\"bash\" noLines>\nsudo nano /etc/mosquitto/conf.d/local.conf\n</LessonCodeWrapper>\n\nAgrega lo siguiente al archivo:\n\n<LessonCodeWrapper language=\"bash\">\nlistener 1883\nallow_anonymous false\npassword_file /etc/mosquitto/passwd\n</LessonCodeWrapper>\n</li>\n\n<li>\n\nGuarda el archivo y reinicia el servicio:\n\n<LessonCodeWrapper language=\"bash\" noLines>\nsudo systemctl restart mosquitto\n</LessonCodeWrapper>\n</li>\n\n<li>\n\nFinalmente, verifica el estado del broker:\n\n<LessonCodeWrapper language=\"bash\" noLines>\nsystemctl status mosquitto\n</LessonCodeWrapper>\n\nDeberías ver algo como esto:\n\n<LessonImages src=\"smart-house-course/lesson-3-2.jpg\" alt=\"code\"/>\n</li>\n</List>\n</li>\n\n<li>\n\nConfiguración de Home Assistant y MQTT\n\n<List>\n\n<li>\n\nAbre el navegador web y ve a <code>http://%DIRECCION_IP_DE_RASPBERRY%:8123</code>. (con la misma dirección IP que encontraste en la lección anterior). Ten en cuenta que la dirección IP de Raspberry Pi puede cambiar con el tiempo debido a la configuración del enrutador. \n\n<LessonVideo controls :videos=\"[{src: 'https://crustipfs.info/ipfs/QmYd1Mh2VHVyF3WgvFsN3NFkozXscnCVmEV2YG86UKtK3C', type:'mp4'}]\" />\n\n</li>\n\n<li>\n\nEn la primera página, ingresa cualquier nombre, nombre de usuario, contraseña que desees y haz clic en \"<code>CREAR CUENTA</code>\"\n</li>\n\n<li>\n\nA continuación, ingrese un nombre para su hogar y configure su ubicación y sistema de unidades. Haga clic en \"<code>DETECT</code>\" para encontrar su ubicación y configurar su zona horaria y sistema de unidades en función de esa ubicación. Si prefiere no enviar su ubicación, puede configurar estos valores manualmente.\n\n</li>\n\n<li>\n\nEn la siguiente pantalla, Home Assistant mostrará cualquier dispositivo que haya descubierto en su red. No se preocupe si ve menos elementos de los que se muestran a continuación; siempre puede agregar dispositivos manualmente más tarde. Por ahora, simplemente haga clic en <code>FINISH</code> y estará en la pantalla principal de Home Assistant.\n\n</li>\n\n<li>\n\nAhora necesitamos instalar una integración MQTT. Vaya a <code>Settings</code> -> <code>Devices & Services.</code>\n\n<LessonVideo controls :videos=\"[{src: 'https://crustipfs.info/ipfs/QmYm9qNfpGdePRHRvmahY2DgHXRfAWNN6CasEY4tFRBARr', type:'mp4'}]\" />\n\n</li>\n\n<li>\n\nPresione el botón <code>ADD INTEGRATION</code> en la esquina inferior derecha. En la ventana abierta, busque <code>MQTT</code>.\n\n</li>\n\n<li>\n\nSeleccione MQTT y configure la dirección de su broker — <code>localhost</code> puerto — <code>1883</code> y su nombre de usuario y contraseña (los mismos que creó anteriormente para Mosquitto Broker) luego presione <code>SUBMIT</code>.\n</li>\n\n</List>\n</li>\n</List>","fileInfo":{"path":"es/learn/smart-home-course/mqtt-broker-setup.md","name":"mqtt-broker-setup"},"defaultName":"Sovereign Smart Home with Robonomics and Home Assistant","lastUpdate":"Thu May 18 2023 10:46:29 GMT+0400 (Samara Standard Time)"}},"context":{}}