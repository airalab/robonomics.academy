{"hash":"747fe7ef75ee9f5c9a3260f3225c1f4d5c548a18","data":{"course":{"id":"f2cd8e7c961fbaeb375f57b3c1416bfe","title":"Leçon n°3, Configuration du courtier MQTT et initialisation de Hass","description":"cours d'assistant domestique","content":"\n## Introduction\nAprès avoir terminé la configuration du Raspberry Pi, la prochaine étape consiste à installer le courtier MQTT sur le Raspberry Pi. Comme mentionné précédemment, le courtier est responsable du routage des messages entre différents clients MQTT. Vous installerez et configurerez Eclipse Mosquitto, un courtier MQTT open source.\n\n<LessonImages src=\"smart-house-course/lesson-3-1.jpg\" alt=\"scheme\" imageClasses=\"mb\"/>\n\nDe plus, vous allez terminer la configuration de Home Assistant et ajouter une intégration MQTT à celui-ci.\n\n## Instructions\n\n<List type=\"numbers\">\n\n<li>\n\n\nInstallation du courtier Mosquitto\n\n<List>\n<li>\n\nInstallez le [courtier Mosquitto](https://mosquitto.org/) sur votre Raspberry Pi :\n\n\n<LessonCodeWrapper language=\"bash\" noLines>\nsudo apt install mosquitto mosquitto-clients -y\n</LessonCodeWrapper>\n</li>\n\n<li>\n\nEntrez VOTRE_NOM_UTILISATEUR (utilisez celui que vous voulez) et le mot de passe (vous devrez entrer le mot de passe après la commande) :\n\n<LessonCodeWrapper language=\"bash\" noLines codeClass=\"big-code\">\nsudo mosquitto_passwd -c /etc/mosquitto/passwd YOUR_USERNAME\n</LessonCodeWrapper>\n\n</li>\n\n<li>\n\nÉditez le fichier de configuration :\n\n<LessonCodeWrapper language=\"bash\" noLines>\nsudo nano /etc/mosquitto/conf.d/local.conf\n</LessonCodeWrapper>\n\nAjoutez ce qui suit au fichier :\n\n<LessonCodeWrapper language=\"bash\">\nlistener 1883\nallow_anonymous false\npassword_file /etc/mosquitto/passwd\n</LessonCodeWrapper>\n</li>\n\n<li>\n\nEnregistrez le fichier et redémarrez le service :\n\n<LessonCodeWrapper language=\"bash\" noLines>\nsudo systemctl restart mosquitto\n</LessonCodeWrapper>\n</li>\n\n<li>\n\nEnfin, vérifiez l'état du courtier :\n\n<LessonCodeWrapper language=\"bash\" noLines>\nsystemctl status mosquitto\n</LessonCodeWrapper>\n\nVous devriez voir quelque chose comme ceci :\n\n<LessonImages src=\"smart-house-course/lesson-3-2.jpg\" alt=\"code\"/>\n</li>\n</List>\n</li>\n\n<li>\n\nConfiguration de Home Assistant et MQTT\n\n<List>\n\n<li>\n\nOuvrez le navigateur web et allez à <code>http://%ADRESSE_IP_DU_RASPBERRY%:8123</code> (avec la même adresse IP que celle trouvée dans la leçon précédente). Soyez conscient que l'adresse du Raspberry Pi peut changer dans le temps en raison des paramètres du routeur. \n\n<LessonVideo controls :videos=\"[{src: 'https://crustipfs.info/ipfs/QmYd1Mh2VHVyF3WgvFsN3NFkozXscnCVmEV2YG86UKtK3C', type:'mp4'}]\" />\n\n</li>\n\n<li>\n\nSur la première page, entrez le nom, le nom d'utilisateur et le mot de passe que vous souhaitez, puis cliquez sur \"<code>CRÉER UN COMPTE</code>\"\n</li>\n\n<li>\n\nEnsuite, entrez un nom pour votre maison et définissez votre emplacement et votre système d'unités. Cliquez sur \"<code>DETECT</code>\" pour trouver votre emplacement et définir votre fuseau horaire et votre système d'unités en fonction de cet emplacement. Si vous préférez ne pas envoyer votre emplacement, vous pouvez définir ces valeurs manuellement.\n\n</li>\n\n<li>\n\nÀ l'écran suivant, Home Assistant affichera tous les appareils qu'il a découverts sur votre réseau. Ne vous inquiétez pas si vous voyez moins d'éléments que ce qui est indiqué ci-dessous; vous pouvez toujours ajouter des appareils manuellement plus tard. Pour l'instant, cliquez simplement sur <code>FINISH</code> et vous serez sur l'écran principal de Home Assistant.\n\n</li>\n\n<li>\n\nMaintenant, nous devons installer une intégration MQTT. Allez dans <code>Paramètres</code> -> <code>Appareils et services.</code>\n\n<LessonVideo controls :videos=\"[{src: 'https://crustipfs.info/ipfs/QmYm9qNfpGdePRHRvmahY2DgHXRfAWNN6CasEY4tFRBARr', type:'mp4'}]\" />\n\n</li>\n\n<li>\n\nAppuyez sur le bouton <code>AJOUTER UNE INTÉGRATION</code> dans le coin inférieur droit. Dans la fenêtre ouverte, trouvez <code>MQTT</code>.\n\n</li>\n\n<li>\n\nSélectionnez MQTT et configurez l'adresse de votre courtier — <code>localhost</code> port — <code>1883</code> et votre nom d'utilisateur et mot de passe (les mêmes que ceux que vous avez créés précédemment pour le courtier Mosquitto) puis appuyez sur <code>SUBMIT</code>.\n</li>\n\n</List>\n</li>\n</List>","fileInfo":{"path":"fr/learn/smart-home-course/mqtt-broker-setup.md","name":"mqtt-broker-setup"},"defaultName":"Sovereign Smart Home with Robonomics and Home Assistant","lastUpdate":"Thu May 18 2023 10:46:29 GMT+0400 (Samara Standard Time)"}},"context":{}}