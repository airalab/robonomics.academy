{"hash":"66c202d3783d3c594c78856019b23f3916cdea2f","data":{"course":{"id":"9afb3e2027e11b6aef2cb0503c7d0f0f","title":"第3課、MQTTブローカーのセットアップとHassの初期設定","description":"ホームアシスタントコース","content":"\n## イントロ\n\nRaspberry Piの設定が完了したら、次のステップはRaspberry PiにMQTTブローカーをインストールすることです。前述のように、ブローカーは異なるMQTTクライアント間のメッセージルーティングを担当しています。オープンソースのMQTTブローカーであるEclipse Mosquittoをインストールして設定します。\n\n<LessonImages src=\"smart-house-course/lesson-3-1.jpg\" alt=\"scheme\" imageClasses=\"mb\"/>\n\nさらに、Home Assistantのセットアップを完了し、MQTT統合を追加します。\n\n## 手順\n\n<List type=\"numbers\">\n\n<li>\n\n\nMosquittoブローカーのインストール\n\n<List>\n<li>\n\nRaspberry Piに[Mosquittoブローカー](https://mosquitto.org/)をインストールします:\n\n\n<LessonCodeWrapper language=\"bash\" noLines>\nsudo apt install mosquitto mosquitto-clients -y\n</LessonCodeWrapper>\n</li>\n\n<li>\n\nYOUR_USERNAME（任意のものを使用）とパスワード（コマンドの後にパスワードを入力するように求められます）を入力します:\n\n<LessonCodeWrapper language=\"bash\" noLines codeClass=\"big-code\">\nsudo mosquitto_passwd -c /etc/mosquitto/passwd YOUR_USERNAME\n</LessonCodeWrapper>\n\n</li>\n\n<li>\n\n設定ファイルを編集します:\n\n<LessonCodeWrapper language=\"bash\" noLines>\nsudo nano /etc/mosquitto/conf.d/local.conf\n</LessonCodeWrapper>\n\n次の内容をファイルに追加します:\n\n<LessonCodeWrapper language=\"bash\">\nlistener 1883\nallow_anonymous false\npassword_file /etc/mosquitto/passwd\n</LessonCodeWrapper>\n</li>\n\n<li>\n\nファイルを保存してサービスを再起動します:\n\n<LessonCodeWrapper language=\"bash\" noLines>\nsudo systemctl restart mosquitto\n</LessonCodeWrapper>\n</li>\n\n<li>\n\n最後に、ブローカーの状態を確認します:\n\n<LessonCodeWrapper language=\"bash\" noLines>\nsystemctl status mosquitto\n</LessonCodeWrapper>\n\n次のようなものが表示されるはずです:\n\n<LessonImages src=\"smart-house-course/lesson-3-2.jpg\" alt=\"code\"/>\n</li>\n</List>\n</li>\n\n<li>\n\nHome AssistantとMQTTのセットアップ\n\n<List>\n\n<li>\n\nウェブブラウザを開き、<code>http://%RASPBERRY_IP_ADDRESS%:8123</code>に移動します（前のレッスンで見つけたIPアドレスと同じ）。ただし、ルーターの設定により、Raspberry Piのアドレスが変わる可能性があることに注意してください。 \n\n<LessonVideo controls :videos=\"[{src: 'https://crustipfs.info/ipfs/QmYd1Mh2VHVyF3WgvFsN3NFkozXscnCVmEV2YG86UKtK3C', type:'mp4'}]\" />\n\n</li>\n\n<li>\n\n最初のページで、任意の名前、ユーザー名、パスワードを入力し、「<code>CREATE ACCOUNT</code>」をクリックします\n</li>\n\n<li>\n\n次に、自宅の名前を入力し、場所と単位系を設定してください。「<code>DETECT</code>」をクリックして、場所を検出し、その場所に基づいてタイムゾーンと単位系を設定します。場所を送信したくない場合は、これらの値を手動で設定できます。\n\n</li>\n\n<li>\n\n次の画面では、Home Assistant がネットワーク上で検出したデバイスを表示します。以下に表示されているアイテムよりも少ないアイテムが表示されても心配しないでください。後でデバイスを手動で追加することができます。今は、<code>FINISH</code> をクリックして、メインの Home Assistant 画面に移動します。\n\n</li>\n\n<li>\n\n次に、MQTT 統合をインストールする必要があります。<code>Settings</code> -> <code>Devices & Services.</code> に移動します。\n\n<LessonVideo controls :videos=\"[{src: 'https://crustipfs.info/ipfs/QmYm9qNfpGdePRHRvmahY2DgHXRfAWNN6CasEY4tFRBARr', type:'mp4'}]\" />\n\n</li>\n\n<li>\n\n右下隅にある <code>ADD INTEGRATION</code> ボタンを押します。開かれたウィンドウで <code>MQTT</code> を見つけます。\n\n</li>\n\n<li>\n\nMQTT を選択し、ブローカーアドレスを設定します — <code>localhost</code> ポート — <code>1883</code> およびユーザー名とパスワード（Mosquitto Broker で以前に作成したもの同じ）を入力して、<code>SUBMIT</code> を押します。\n</li>\n\n</List>\n</li>\n</List>","fileInfo":{"path":"ja/learn/smart-home-course/mqtt-broker-setup.md","name":"mqtt-broker-setup"},"defaultName":"Sovereign Smart Home with Robonomics and Home Assistant","lastUpdate":"Thu May 18 2023 10:46:29 GMT+0400 (Samara Standard Time)"}},"context":{}}