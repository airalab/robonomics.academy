---
title: "第三部分：世界计算机的出现"
description: 在标题为“世界计算机的出现”的第三部分中，我们将尝试逐层重建世界计算机的工程实现，使用以太坊和Polkadot的示例，就像之前一样。
metaOptions: [学习]
defaultName: "World computer in your home"
---

在标题为“世界计算机的出现”的第三部分中，我们将尝试逐层重建世界计算机的工程实现，使用以太坊和Polkadot的示例，就像之前一样。

让我们从以太坊开始。以太坊始于2015年，其状态可以描述为一种结合了工作量证明共识算法的状态，使世界计算机能够以分散状态存在（如第2部分所讨论的）。此外，引入了以太坊虚拟机（EVM），作为一个图灵完备的计算机。这两个元素共同形成了世界计算机的第一个版本，有时被称为前身。在这种情况下，分散式应用程序或智能合约开始出现。

在接下来的5年里，以太坊过着相对不变的生活，经历了一些工程调整，例如持续增加燃气限制，除了上海分叉等事件。值得注意的是，在上海举行的第二次DEFCON中，一次拒绝服务攻击利用了虚拟机中的一个函数，消耗了最少的燃气，但在以太坊网络上触发了重要的计算。这导致内存溢出，有效地破坏了整个以太坊节点。这一事件突显了处理像创建虚拟机这样的大型和抽象解决方案时出现的复杂细节。

在接下来的十年末，特别是在2020年，发生了重大转变，以太坊2.0的出现。然而，以太坊2.0现已被弃用，我认为真正的突破是从2019年至2020年开始的。在这段时间内，以太坊出现了真正的技术突破，朝着以太坊2.0的概念迈进。以太坊架构的工程变化时刻可以被认为是被称为“合并”的事件，其中信标链的功能被合并。合并标志着以太坊范式的重大转变，将其转变为与之前不同的状态。以太坊架构的实际工程变化可以与“合并”相关联，其中信标链的功能被整合。有关此的详细历史，您可以参考ethereum.org网站，该网站提供了一篇关于传统以太坊区块链与2015年启动的并行区块链以及以太坊虚拟机共存的优秀文章。

当合并发生时，我们目睹了一个新的架构表示，无论是在网络层还是与以太坊网络交互的个体节点。实际的变化是什么？对许多人来说，合并标志着从工作量证明到股权证明的过渡，这确实很重要。这意味着效率和微调的提高，但相对于其中一个参数仍然是一种调整。然而，对于每个网络客户端来说，更值得注意的内部工程变化是分裂。不再有单一特定的网络客户端或单片架构。相反，我们得到了与以太坊网络交互的单个节点的两个组件。

第一部分，我在图表上标记为“信标链”，实质上代表了在合并时刻进入以太坊客户端的所有创新的集体形象。第二部分是保留的虚拟机。然而，在这里也值得补充一些内容。关于替换虚拟机的对话真正开始了，这个虚拟机是专门为与智能合约和特定语言Solidity中的智能合约一起工作而定制的。这是因为到2015年，除了Solidity之外，几乎没有留下为智能合约编写解释器的语言，从以太坊程序员的角度来看，架构似乎有些片面。你学习一点JavaScript，以Solidity的形式，编写智能合约代码，然后得到你的DApp，比如Uniswap，例如。

自从更复杂的以太坊架构出现以来，讨论围绕着这样一个想法展开，即从2015年起作为一种有些单片化元素存在的虚拟机也可以在新架构中被替换。对话转向用类似WebAssembly（Wasm）或从编写世界计算机代码的角度来看更有趣的解决方案来替换它。你可以说，“带着一个问号的Wasm。”

从信标链的角度来看，它确实在股权证明上运作，但更有趣的是加斯帕的加入。这代表了对Casper原始想法的修改。Casper通常被称为友好的幽灵终结装置，可能早在Defcon 3或4时引入，甚至可能在Defcon 2时讨论过——我记不太清楚了。但在巴黎的EthCC会议上，维塔利克和弗拉德·扎米尔从不同的房间讨论了Casper作为友好的幽灵的出现，监督股权证明的参与者，并在节点行为不端时帮助网络。从Casper的这个想法中，Gasper出现了。不深入术语太多，共识算法发生了变化，不仅在简单性方面发生了变化，而且变得更加复杂，类似于Polkadot。正如我之前提到的，Polkadot有两种共识算法，Babe和Grandpa。同样，在以太坊的信标链功能中，达成共识和终局性并不是瞬间完成的。它涉及到时代，网络在更复杂的情景下运作，达到了一个已经有些动态的状态，不���冻结的，基本上是铭刻在石头上的。

{关于2024年还可以补充什么？对我来说，这是一个长时间的观察和尝试理解以太坊最终是否会实现分片。分片是指不仅存在于单一区块链中，而且在一个网络中存在多个区块链的能力。当我观察到合并和同时崛起的第二层（L2）网络时，我脑海中出现了关于分片是否会实现的问题。分片对我来说似乎很有趣，因为它的同质性——有多个几乎相同的链，缺乏任何特定特征。这似乎是一种有趣的方法，但不像异质方法那样灵活。在第二层网络中，即使在几年前，我也能看到以太坊的异质性，它能够与各种类型的更具体的区块链一起工作。我对它将走向何方很感兴趣——分片是否会以其同质性取代L2解决方案，还是L2解决方案以异质方法饱和信标链和以太坊网络的主节点。

今天，在2024年，根据ethereum.org上的文章，似乎分片作为一个概念已经被推迟，重点是帮助各种L2网络与信标链集成，并与主链的功能对齐，这些功能现在在以太坊网络架构中分为两个元素。

因此，不深入探讨L2网络的结构细节——尽管当我们填写委员会的第二部分时会涉及到这一点——我们应该想象以太坊现在是一种信标链，一个信标，众多L2网络的指引之星。这些L2网络可以具有更具体的功能，根据一组个别功能执行其逻辑。这在某种程度上符合瑞士军刀的概念——并非让以太坊成为瑞士军刀，而是L2网络开始在架构上有所区别。它们复制了以太坊的抽象计算机的功能，但以更低的燃气成本或在其特定领域内执行。一些人已经开始考虑调整并使其L2层更高效，专注于特定的功能能力。因此，在我看来，我们正在见证旨在成为同质化的世界计算机中异质性的出现。此外，重要的是不要忘记去中心化应用（dApps）仍存在于主区块链内，在那个从2015年开始的同一区块链内。这意味着在合并过程中，在过渡到新的架构状态时，没有擦除，没有抹去先前的历史。所有去中心化应用和支撑这些应用的智能合约继续存在，今天继续存在，可能明天也会存在。这是一个我们将使用Polkadot作为例子来探讨的问题，但仍然有一种感觉，即将能够在信标链中安置���个去中心化应用——dApps。

总之，让我们想象今天以太坊的工程实现为一个世界计算机。我们每个网络节点由两部分组成。第一层负责以太坊虚拟机（EVM），实际上是虚拟机或图灵完备机器的功能，如果我们用理论术语来说。也许我们将看到2015年设计的虚拟机的替代品的出现。这些替代品可能会在更抽象的编程可能性方面超越它，比如在Solidity中编写智能合约。同时，Solidity中的智能合约仍然感觉舒适。如果您想为以太坊主链编写功能而不在以太坊之上创建任何基础设施，也不将任何计算外包以降低成本等，您可以将作为智能合约编写的去中心化应用仍然放在以太坊的主区块链中。同时，信标链功能已经出现，将验证者之间的共识逻辑与计算机的主协议分开。这允许在共识应该如何工作以及如何进一步修改共识时具有额外的灵活性，而不影响虚拟机本身。上海和Defcon 2的例子，一个小的操作码错误导致部分基础设施的关闭，暗示着将这样复杂的功能分为两部分是有好处的。

信标链有什么有趣的地方？它是一个更复杂、更全面的算法，用于实现网络同步性和最终性，引入了“纪元”等概念，以及网络中存在的幽灵。

最后，现在需要考虑的重要问题是，以太坊实际上正在结束同质化，结束让一百个相同的区块链与相同的虚拟机一起运行的想法，其中在Solidity中编写的智能合约可以驻留。相反，各种项目正在提出自己的架构或将相同的虚拟机带出主区块链的限制。或者，他们试图构建更具体的应用程序，这在信标链的主链级别上是用Solidity编写的智能合约。这是以太坊的当前表现，它没有成为以太坊2.0。它仍然是同样的以太坊——一个最初以工作证明+图灵完备机器开始的项目，转变为这种架构。

现在，让我们看看Polkadot在过去5年中是如何出现和发展的。Polkadot诞生于以太坊之后的五年，诞生于开发出以太坊最佳客户端之一的团队——Parity。许多人可能还记得他们的Web客户端，与Geth和其他实现相比，至少从个人经验和同事的经验来看，可能更加愉快。

其次，在我看来，Polkadot 是 Gavin Wood 希望融入以太坊开发的想法的延伸。 因此，人们可能会说以太坊在某种程度上分裂成了两个概念。
Polkadot 推出时我们已经有了什么？ 中继链上线。 有趣的是，对吧？ 信标链和中继链。 中继链代表什么？ 最初，无法在那里放置去中心化应用程序、为其编写智能合约或在 WASM 或 Solidity 中上传代码。 在第一个区块或 Polkadot 中继链存在的最初几天，这些都是不可用的。 没有办法添加你的运行时间，我们很快就会讨论这一点，而且它不是基于权益证明； 相反，它使用权威证明。 这使得 Polkadot 开发人员启动的某些节点能够在最初的几个月或几周内存活下来，而攻击可能会在链上发起，或者如果其行为不正确的话。 然而，这种情况很快就发生了变化，中继链转变为权益证明。

最终，在中继链存在几个月而没有任何去中心化应用功能，没有连接您的平行链或L2网络的能力，没有用户功能的情况下，网络从权威状态过渡到了权益证明。这使开发人员能够上传他们的运行时。

此时，讨论今天的以太坊与Polkadot的中心部分结构之间的差异也很有趣。从我们已经讨论过的核心的角度来看，不仅对于以太坊和Polkadot，而且对于任何想要被呈现为抽象计算机的项目来说，图片将完全相同。然而，从工程和架构的角度来看，观察Beacon Chain和Relay Chain是很有趣的。在这里，我们有一个虚拟机，自2015年以来一直被继承，但也提出了替代方案。在中继链中，有上传您的运行时的能力。运行时实际上就是您的虚拟机。例如，一些平行链完全模拟以太坊虚拟机。它被写入为运行时，这意味着您可以在Polkadot的平行链级别上传一个以太坊虚拟机的模拟，或者编写更具体的逻辑，与四五个功能一起工作。回想第一部分关于想法——您可以编写您的瑞士军刀，但不需要创建整个基础设施。您可以在运行时级别使用特定功能实现特定功能，将其放入Polkadot中继链，并且Polkadot验证者将确保此运行时的不可变性。

接下来会发生什么？大约一年的时间里，一层平行链开始围绕中继链形成。就以太坊实现而言，你可以说L2网络与平行链非常相似。然而，在波卡中有一个有趣的跨网络区别让我着迷，我正在努力进一步了解它——即第二层验证和数据可用性检查。几年后，波卡变成了这样。它不仅仅是一个中继链，其中权益证明验证者保护未来平行链的运行时；还有一个额外且至关重要的数据验证和可用性检查层从平行链中出现。

当你看这个图表时，试着注意出现的类比和工程实现细节上的差异。那么，这代表着什么，这个方案与以太坊相比如何？我们有一个L2项目，在这种情况下，是波卡的一个平行链。平行链也生成信息块，然后发送到中继链上进行组合，并释放一个中继链块，作为所有头部、头部和更多头部的总和。平行链使用收集器在一个块中收集交易，这些收集器不参与验证。他们在中继链上不抵押任何东西；他们只使用运行时，它在中继链上。他们获取它，应用于交易，执行必要的状态转换，形成一个块，并且，至关重要的是，提供有效性证明——包含���密证明的印章，证明收集器正确地组装了块。这些信息传递到中继链的外部验证环。在这个环中，有波卡的内部验证者——平行链收集器。同样，从中继链的角度来看，他们不直接从中继链抵押任何东西。平行链实现有时会在收集器之间引入他们的共识，有些则不会。例如，在实现平行链的Robonomics中，我们发现这种范式更有趣，更少负担，并且使网络更简单，同时仍然保持功能上的实质性。任何收集器，不需要与任何人达成共识——由我们验证——都可以提出一个块和一些证明给外部层。这正是为什么块被提出，块组装有效性的证明被提供，以及有一个外部环。我们不需要从平行链验证者那里得到任何共识。任何人都可以生成一个块并发送它，如果这个收集器节点向外部环上的平行链验证者发送不正确的信息，那么这个级别的验证者将拒绝它。它不会通过到中心部分。但是假设收集器正确提供了块。我们的交易进入了；收集器计算它们，应用存储在中继链中的运行时，执行所有状态转换，收集一些有效性证明——组装块的有效性，并将其传递给中继链的外部环。在这里，每个纪元，也是最终化的一部分，每个纪元都有���自中继链的验证者分散到平行链中。其中一些留在中心，其他的去到平行链。他们的数量从16到64个验证者不等，我相信这个数字会在规范中改变——有些地方更多，有些地方更少。然而，平行链验证者重新验证来自一个选定的验证者组的关于来自收集器的一切都是正确的信息，工作是按照运行时进行的，并且有效性证明确实有效。已经抵押了一些东西的中继链验证者的选定部分会回应，或者说，他们之间会互相交流。他们会回应给被选择的平行链主块生产者，可以这么说，说， “是的，我们同意。没有问题。你可以将其通过整个外部环内部。”

因此，几乎所有形成在平行链收集器上的信息，通过外部环的验证，进入内部环。下部分，不是物理上在底部，仍构成外部环—数据可用性。数据开始在这个阶段进行检查，这意味着在外部环上，不仅验证了区块组装的正确性，还开始了在Polkadot网络内部分发的准备过程，确保区块信息不会在未来丢失。在这里，正是我在第二部分提到的关于块的内容，就像CD RW一样。在将区块准备转移到内部环的这个阶段，数据可用性层被形成为一种服务，目前也有一些以太坊项目尝试这样做。一些项目直接将额外的冗余信息放入智能合约中，用于检查L2层上发生的情况，并在必要时对那些错误操作的人进行惩罚。在不分发区块信息并在假设运行时必须正确工作的几十个节点上重新检查的情况下，是不可能克服外部环的。

因此，通过外部环的信息已经相当可信，可能是的，你可以这么说，在内部环中，主要的工作不是处理平行链区块，而是将它们的区块头收集到一个大头部中。也就是说，从许多头部中，组装成一个中继链区块的头部—在Polkadot中提到的共享安全机制，确保平行链的安全。可以说，平行链经过验证并达到了一个状态，在外部环中以分布式去中心化形式存在的服务。在内部环中，进入的信息试图汇聚在一个超级块中，这应该精确地将所有内容连接在一起。那里没有发生计算；没有对绝对所有内容进行重新计算。最终区块的组装发生在当前世界计算机的迭代中，以解决交易是否在特定平行链中通过的问题。我们必须组装一个超级块，其中包含不是所有来自平行链的信息，而是将所有在外部环中验证的平行链头部汇集到一个大区块中。因此，在Polkadot中，我们的世界计算机运行。

让我们再一起看看这两个方案：中继链、信标链、运行时，由权益证明保护，某人押注他们的资金来验证他们将始终正确执行工作。有一个虚拟机，您也可以押注您的资金，如果您执行任何与以太坊虚拟机规范不符的计算或状态转换，您将受到惩罚。

在Polkadot中，还有一个额外的外部层，这似乎是主要优势之一，这种工程实现的愉快优势，在我看来，应该在这里出现。它应该出现在L2网络和以太坊中存在的信标链之间。顺便说一句，有人说“信标链”这个术语再次消失并且被误解了，但我真的很喜欢将其与“中继链”这个术语进行类比，这是以太坊路线图中的一个术语。

在 Polkadot 中，有一个外部层，或者更确切地说，我认为它的发明是为了解决当您拥有 L2 或一组需要连接的区块链时出现的许多问题。 在这一层，实现了信息分发的工程机制，以使其在去中心化网络中可用。 引入了额外的算法，不仅用于检查有效性，还用于验证器检查信息的可用性。 另外，还有一种机制可以在每个时期将一部分 Polkadot 验证器随机分配给特定的平行链。 因此，每个时期都由不同的验证器为平行链提供服务； 它们在每个时期都会被洗牌并发送到不同的平行链。 当将一个块从外环传输到内环时，验证器会沿途重新检查，并与分配给平行链的验证器进行协调。 目前，这个过程并不存在，但我认为它会在某个时候出现。
也许最后一点是关于整理者的，它在今天的平行链中实现得非常有趣。 它们可以是共识，也可以没有共识而存在，但事实上，它是有效的。 至于具有去中心化排序器的 L2 网络中的问题，或者在虚拟机中定居之前如何生成和验证块的问题 - 这些是以异构格式实现以太坊的单独问题。 在我看来，这一天在 Polkadot 中得到了很好的实现。 然而，这并不意味着 Polkadot 领先于整个地球，它永远无法赶上以太坊。 虽然正是这个架构吸引了我继续工作，并希望 Polkadot 在技术方面继续发展得很好，因为我在所有连接的方面还没有看到这样的东西。

也许在讲座的这一部分中还有一个更有趣的故事：到目前为止，我们几乎无法想象以太坊L2网络之间适当的跨链消息。也许我在论文中漏掉了什么，但是当你没有外部环，以及像收集器、部分验证器和数据可用性服务等问题没有解决时，思考两个L2层如何进行通信是具有挑战性的。然而，在Polkadot中，这是存在的。甚至横向通过中继链，意味着直接地，一个可以安全地从一个平行链发送交易到另一个，而不需要信任这两个平行链之间的任何桥梁。这是另一个关键的功能，可能需要在连接L2网络的层面实现。以太坊中的智能合约通信良好。我们已经创建了许多链接智能合约的链条，其中一个触发另一个。对此，没有问题。但是当我们说几乎所有应用程序都在异构网络的L2层移动时，我听到如果你住在特定地区，你将无法离开。在Polkadot的平行链和实现层面上，情况并非如此。这两种架构都值得关注，因为在我看来，工程实现遵循成为全球计算机的主流路径。它们略有不同，但也有许多相似之处。到处都有大量的工程工作。正如我们所看到的，人类文明以研究��员、工程师和不断增长的开发人员为形式，拥有大量资源用于进一步发展，大致朝着从最初阶段到可能未来建立世界计算机的方向前进，都在同一轨道上。
